class BrazilMapComponent extends HTMLElement {
    constructor() {
        super();
        this.shadow = this.attachShadow({ mode: "open" })
    }
    connectedCallback() {
        this.render();
        let path = this.shadow.querySelectorAll(".thp-brazil-state");
        path.forEach((item) => item.addEventListener("mouseover", this.handleMouseover.bind(this)))
        path.forEach((item) => item.addEventListener("mouseleave", this.handleMouseleave.bind(this)))
    }
    handleMouseover(state) {
        const statesWithThpProjects = ['SE', 'BA', 'AM', 'MA', 'CE', 'PB', 'AL', 'RJ', 'MG', 'ES', 'SP']
        if (statesWithThpProjects.find((s) => s === state.target.id)) {
            const messageBox = this.shadowRoot.querySelector('message-box-component');
    
            messageBox.createMessage(state.target.id)
            this.draw(this.position(state.target.id), state.target.id)

            this.shadowRoot.querySelector(".white-line").addEventListener('animationend', () => {
                messageBox.showMessage()
            });
        } 
    }
    handleMouseleave() {

        const messageBox = this.shadowRoot.querySelector('message-box-component');
                
        messageBox.clearMessage()
        this.erase();
    }
    position(stateId) {
        const brazilMapState = this.shadowRoot.querySelector(`.thp-brazil-map #${stateId}`);
        var bbox = brazilMapState.getBBox();

        var centerX = bbox.x + bbox.width / 2;
        var centerY = bbox.y + bbox.height / 2;


        const coordinatesbrazilMapState = {
            x: centerX,
            y: centerY
        }
        return coordinatesbrazilMapState;
    }
    draw(stateXY, stateId) {
        const whitLine = this.shadow.querySelector('.white-line');
        const circle = this.shadow.querySelector('.circle');
        const messageBoxContainer = this.shadow.querySelector('.message-box-container');
        const messageBox = this.shadow.querySelector('message-box-component').shadow.querySelector('.thp-message-box');
        const state = this.data().states.find((item) => item.id == stateId)
   
        let messageX = (state.messageX ) 
        let messageY = state.messageY
        
        messageBoxContainer.setAttribute('x', messageX)
        messageBoxContainer.setAttribute('y', messageY)
    /*     messageBoxContainer.setAttribute('height', messageBox.clientHeight)
        messageBoxContainer.setAttribute('width', messageBox.clientWidth) */
        
        console.log(messageBox.clientWidth, messageBox.clientHeight)
        /*  if (stateXY.y > messageY) {
            messageY = messageY + 100
        } */

        let d = `M ${stateXY.x}, ${stateXY.y} H  ${messageX} V ${messageY} `;

       /*  if (stateId === "MG" || stateId === "ES") {
            messageX = 232 + 313;
            messageY = stateXY.y
            d = `M ${stateXY.x}, ${stateXY.y} L ${messageX}, ${messageY}`
        } */

        whitLine.setAttribute('d', d);
        const tamanhoTotalDoPath = whitLine.getTotalLength();
        whitLine.style.setProperty('--tamanhoTotalDoPath', tamanhoTotalDoPath)
        whitLine.classList.remove('hide')

        whitLine.addEventListener('animationend', () => {
            circle.setAttribute('cx', messageX)
            circle.setAttribute('cy', messageY)
            circle.classList.remove('hide')
        });
    }
    erase() {
        const whitLine = this.shadow.querySelector('.white-line');
        const circle = this.shadow.querySelector('.circle');

        whitLine.setAttribute('d', '');
        whitLine.classList.add('hide');

        circle.setAttribute('cx', '')
        circle.setAttribute('cy', '')
        circle.classList.add('hide')

    }
    data() {
        return {
            states: [
                { id: "RS", messageX:"", messageY:"", d: "M653.973 486.435L659.475 487.738L663.913 486.435L668.172 487.738H673.676L677.935 490.757H682.728L690.895 496.617L694.799 503.012L706.693 503.722L707.077 505.913L703.763 508.132L703.821 511.299L702.137 513.373L707.165 514.97L702.431 521.72L699.768 530.247L693.733 538.889L685.509 547.297L679.592 549.546L673.201 555.23L671.189 562.335L667.166 568.491L660.066 574.175H657.109L658.054 569.676L657.109 566.006L659.357 563.756L663.734 561.15L661.723 558.901L658.529 558.428L656.244 556.651L654.622 551.441L645.63 547.061L644.328 543.745L640.305 543.035L638.293 540.902L635.925 541.02L634.268 538.179L630.956 534.864L627.288 538.416L624.683 537.943L625.749 534.272L615.453 525.036L611.902 524.563L609.3 526.339L606.894 527.759L605.316 526.734L608.433 524.324L608.551 522.548L609.457 521.444L611.39 521.208L615.531 517.379L618.057 512.957L620.542 512.524L622.02 508.695L625.807 504.552L628.115 503.191L629.95 503.722L630.602 502.124L629.181 500.644L635.155 496.559L636.754 497.032L639.654 495.019L640.363 492.948L645.097 491.051L648.766 490.52L649.357 488.744L651.486 488.508L652.019 486.731L653.973 486.435Z" },
                { id: "PR", messageX:"", messageY:"", d: "M647.327 445.032L650.126 443.571L651.901 436.584L654.622 435.399L656.244 429.955L663.025 425.927L667.878 425.099L674.385 426.166L675.688 424.508L683.025 426.757L686.22 426.284L691.662 427.821L693.082 430.073L703.97 429.955L707.875 433.032L708.822 442.504L713.318 448.899L712.134 453.161H721.485L722.549 454.938L721.246 457.781H726.572L728.741 461.212L724.875 464.45L721.564 470.133L713.082 470.806L709.886 473.764H707.875L705.154 471.16L699.356 472.225L696.396 470.924L693.082 473.764H689.532L686.339 475.777L687.284 478.738L684.445 479.921L683.616 478.265L678.29 478.738L675.215 476.844L667.166 475.422L663.261 476.132L660.304 473.764L656.576 474.356L654.425 470.37L652.768 465.319L650.402 463.74L645.352 465.792L643.619 463.267L646.3 459.636L645.827 455.45L647.721 449.373L647.327 445.032Z" },
                { id: "SC", messageX:"", messageY:"", d: "M653.973 486.435L655.985 482.882L655.097 480.396L656.576 474.356L660.304 473.764L663.261 476.132L667.166 475.422L675.215 476.844L678.29 478.738L683.615 478.265L684.445 479.921L687.284 478.738L686.338 475.777L689.532 473.764H693.082L696.396 470.924L699.356 472.225L705.154 471.16L707.874 473.764H709.886L713.082 470.806L721.564 470.133L721.246 472.739L722.824 473.449L722.903 474.555L720.537 478.659L720.301 480.633L721.246 481.737L720.773 484.422L721.485 488.566L719.946 490.578L719.71 493.421L721.603 496.025L719.116 504.906L713.082 508.695L707.165 514.97L702.136 513.372L703.821 511.299L703.763 508.132L707.077 505.913L706.693 503.721L694.799 503.012L690.895 496.617L682.728 490.757H677.935L673.676 487.738H668.172L663.913 486.435L659.475 487.738L653.973 486.435Z" },
                { id: "SP", messageX:"850", messageY:"450", d: "M663.025 425.927V424.032L671.189 420.361L676.278 413.85V411.601L677.699 410.534L679.592 407.812L679.12 405.442L682.906 398.219L686.179 395.378H689.296L690.716 391.353L697.105 387.446L699.237 389.222L701.722 388.51L703.851 389.813L709.65 389.222L710.952 390.641H713.082L712.373 392.299L713.082 394.669L714.975 392.417L716.514 392.535V395.97L718.053 396.324L719.353 392.535L726.414 391.668L727.835 392.535L730.437 392.181V390.404L735.92 390.01L738.919 393.208L738.367 396.088L740.34 397.155L741.049 399.049L739.195 401.535L742.272 409.628L745.426 408.521L749.016 411.165L746.729 413.771L747.202 418.112L745.626 420.797L750.279 424.981V429.321H755.408L759.037 427.979L757.931 426.084L759.352 424.508L762.902 425.927L767.713 423.48L771.185 422.455L772.448 425.296L774.735 425.848L776.55 424.508L778.443 425.375L779.076 426.954L776.865 429.046L772.33 430.546L770.2 433.822L770.988 435.044L770.082 435.835L767.834 435.241L764.914 437.769L762.369 438.833L762.666 440.846L761.482 441.676L758.582 440.728L754.736 440.433L752.666 441.973L752.075 444.341L750.712 444.044L750.24 443.098L742.666 447.418L741.424 449.964L730.319 456.95L730.398 459.397L728.741 461.212L726.572 457.781H721.246L722.549 454.938L721.485 453.161H712.134L713.318 448.899L708.822 442.504L707.875 433.032L703.97 429.955L693.082 430.073L691.662 427.821L686.22 426.284L683.025 426.757L675.688 424.508L674.385 426.166L667.878 425.099L663.025 425.927Z" },
                { id: "RJ", messageX:"850", messageY:"450", d: "M771.185 422.455L783.099 418.033L791.381 417.166L792.25 419.218L803.532 413.535L801.953 411.404L804.398 408.245L805.346 402.877L808.106 400.825L810.711 401.298L811.184 405.718L816.155 407.218L819.999 407.279L820.414 409.055L819.054 410.356L820.06 413.02L819.881 416.93L817.633 419.355L813.61 419.888L807.219 425.038L806.806 426.993L808.285 427.821L806.746 429.716L799.705 429.185L792.841 430.485L788.7 429.716L788.227 430.961H786.688L784.084 429.164L778.837 430.961L776.865 429.045L779.076 426.954L778.443 425.375L776.55 424.507L774.735 425.848L772.448 425.296L771.185 422.455Z" },
                { id: "ES", messageX:"850", messageY:"450", d: "M808.106 400.825L809.705 397.094L808.906 394.963L809.705 393.247H814.852L815.858 389.871L817.633 388.865V386.734L820.414 383.715L821.123 379.986L817.573 375.367L817.93 374.242L820.414 374.479L821.123 372.881L819.645 372.348L819.823 369.683H817.87L818.727 366.131L820.651 365.421L823.107 366.073L823.638 365.273L822.396 363.912L823.017 363.082L824.497 363.557L825.798 362.521L829.496 363.024L836.803 367.671L835.797 373.414L837.158 380.814L835.503 385.906L832.602 387.089L830.178 390.05L830.708 393.542L828.697 397.806L825.503 401.832L823.492 402.129L822.898 404.614L819.999 407.279L816.155 407.218L811.184 405.718L810.711 401.298L808.106 400.825Z" },
                { id: "MG", messageX:"850", messageY:"450", d: "M829.496 363.024L830.829 361.039L825.621 355.513L826.173 349.041H829.487L830.432 347.935L829.014 346.831L829.723 344.621L834.14 340.911L834.537 337.674L828.382 334.358L820.572 332.385L818.284 333.806L815.68 333.57L816.076 330.175L810.236 324.964L806.767 326.071L804.873 324.334L803.138 325.437L794.065 318.966H791.066L787.595 321.097L782.466 318.966L783.65 314.701L778.207 313.261L771.817 315.807L767.319 319.991L765.111 320.069L758.564 325.28L754.46 326.938L753.041 325.911L755.486 323.858L755.014 321.727L751.857 322.439L751.384 320.385L749.016 319.439L747.992 320.939L748.78 324.255L747.992 324.807L744.047 323.464L743.021 325.992L744.126 327.647L743.021 329.621V331.357L744.914 332.069V335.464L738.21 337.359V340.278L736.235 342.806V344.067L738.761 345.646L740.122 350.62L735.329 354.942L736.099 357.073L738.05 357.192L738.761 358.908L736.986 361.514L738.05 364.415L730.419 370.038L725.329 368.322H716.929L714.206 369.328L711.188 372.466L709.65 370.632L706.533 372.466L702.945 371.775L702.234 373.078L699.513 372.763L696.908 376.079L696.672 378.367L694.227 378.998L690.834 383.932L689.729 386.655L690.716 391.353L697.105 387.446L699.237 389.222L701.722 388.51L703.851 389.813L709.65 389.222L710.952 390.641H713.082L712.373 392.299L713.082 394.669L714.975 392.417L716.514 392.535V395.97L718.053 396.324L719.353 392.535L726.414 391.668L727.835 392.535L730.437 392.181V390.404L735.92 390.01L738.919 393.208L738.367 396.088L740.34 397.155L741.049 399.049L739.195 401.535L742.272 409.628L745.426 408.521L749.016 411.165L746.729 413.771L747.201 418.112L745.626 420.797L750.279 424.981V429.321H755.408L759.037 427.979L757.931 426.084L759.352 424.508L762.902 425.927L767.713 423.48L771.185 422.455L783.099 418.033L791.381 417.166L792.25 419.218L803.532 413.535L801.953 411.404L804.398 408.246L805.346 402.877L808.106 400.825L809.705 397.094L808.906 394.963L809.705 393.247H814.852L815.858 389.871L817.633 388.865V386.734L820.414 383.715L821.123 379.986L817.573 375.367L817.93 374.242L820.414 374.479L821.123 372.881L819.645 372.348L819.823 369.683H817.87L818.727 366.131L820.651 365.421L823.107 366.073L823.638 365.273L822.396 363.912L823.017 363.082L824.497 363.557L825.798 362.52L829.496 363.024Z" },
                { id: "MS", messageX:"", messageY:"", d: "M690.834 383.933L687.699 379.926H682.195L673.143 375.309L671.013 372.644L666.575 373.533L664.8 371.293L667.818 369.092L666.93 367.434L663.38 368.025L662.492 364.591L659.475 363.29L655.985 364.178L651.665 362.284L653.204 359.501L655.273 359.086L656.244 353.639L654.149 353.224L650.126 358.789H647.287L643.913 356.48L641.192 359.086L634.625 358.316L629.575 354.33L624.447 352.594L619.557 354.409L615.531 354.567L611.666 360.566L608.194 361.118L603.541 355.909L602.081 356.658L603.383 361.278L605.868 366.961L603.029 376.315L598.176 387.209L601.608 390.523L598.176 392.417V394.075L601.372 399.049L602.317 408.522L599.991 417.087L600.779 418.507L604.171 417.876L605.316 419.691L615.059 420.48L619.951 417.876L623.501 420.559L627.918 420.876L629.575 422.455L629.654 424.35L630.917 425.69L630.205 428.927L631.626 432.716L631.862 437.69L633.283 440.373L632.731 443.453L637.148 443.61L643.065 441.795L647.327 445.032L650.126 443.571L651.901 436.584L654.622 435.399L656.244 429.955L663.025 425.927V424.032L671.189 420.362L676.278 413.85V411.601L677.699 410.534L679.592 407.812L679.12 405.442L682.906 398.219L686.179 395.378H689.296L690.716 391.353L689.729 386.655L690.834 383.933Z" },
                { id: "GO", messageX:"", messageY:"", d: "M662.492 364.591L663.734 362.815L661.013 357.962L664.209 347.659L670.362 343.515L667.996 341.148L673.676 335.464H677.935L681.368 330.963L681.84 325.162L684.8 322.912L686.457 324.334L689.729 322.912V315.689L692.728 310.952L692.019 306.69L695.569 300.06L694.857 297.099L696.751 294.495L698.408 289.521H702.194L699.946 294.85L704.324 296.269L711.307 300.888V297.217L713.791 294.02L716.632 296.151L718.053 293.783L722.194 297.217V301.243L726.335 298.284L727.165 301.597L729.058 300.297L730.952 300.651L733.318 303.849L734.502 302.073L733.318 298.52L734.502 297.572L737.577 300.415L745.387 296.626H751.542V301.597L752.724 304.44L751.66 311.309L756.392 314.861L755.014 321.727L751.857 322.439L751.384 320.385L749.016 319.439L747.992 320.939L748.78 324.255L747.992 324.807L744.047 323.464L743.021 325.992L744.126 327.647L743.021 329.621V331.357L744.914 332.069V335.464L738.21 337.359V340.278L736.235 342.806V344.067L738.761 345.646L740.122 350.62L735.329 354.942L736.099 357.073L738.05 357.192L738.761 358.908L736.986 361.514L738.05 364.415L730.419 370.038L725.329 368.322H716.929L714.206 369.328L711.188 372.466L709.65 370.632L706.533 372.466L702.945 371.775L702.234 373.078L699.513 372.763L696.908 376.079L696.672 378.367L694.227 378.998L690.834 383.933L687.699 379.926H682.195L673.143 375.309L671.013 372.644L666.575 373.533L664.8 371.293L667.817 369.092L666.93 367.434L663.38 368.025L662.492 364.591Z" },
                { id: "MT", messageX:"", messageY:"", d: "M696.751 294.495L694.385 291.237L695.569 287.685L695.094 278.745L693.437 277.087L693.733 273.595L695.094 272.234L695.687 265.129L700.419 254.59L616.282 248.434L614.862 246.182H612.02V243.933L609.654 241.802H607.288V240.025H605.04L603.856 235.29V232.093L601.49 228.185L599.833 222.502L597.349 220.844L596.283 223.212V225.224L594.271 227.831L596.046 231.144L595.455 235.052L594.271 236.118V240.856L552.854 240.38L554.272 241.92L553.917 246.421L552.142 246.776V248.552L554.272 250.919L553.208 253.405L553.799 255.775L552.615 257.669L552.736 259.919L554.39 261.813L553.327 269.864L567.526 269.628L568.473 271.404L573.562 271.64L574.508 274.956L571.827 278.312L572.142 281.152L573.956 282.416L574.666 287.075L576.638 288.178L574.902 289.915L572.536 291.258L572.378 296.151L569.597 297.927L568.534 302.782L564.214 305.625L568.592 310.444L566.462 312.832L569.658 318.65L570.367 324.689L566.462 325.398L570.485 330.017L571.433 340.436L592.851 341.739L594.862 340.318L595.692 343.279L592.851 348.132L594.862 354.173L598.176 357.607L602.081 356.658L603.541 355.909L608.194 361.117L611.666 360.566L615.531 354.567L619.557 354.409L624.447 352.593L629.575 354.33L634.625 358.316L641.192 359.086L643.913 356.48L647.287 358.789H650.126L654.149 353.224L656.244 353.639L655.273 359.086L653.204 359.501L651.665 362.284L655.985 364.178L659.475 363.29L662.492 364.591L663.734 362.815L661.013 357.962L664.209 347.659L670.362 343.515L667.996 341.148L673.676 335.464H677.935L681.368 330.963L681.84 325.162L684.8 322.912L686.457 324.334L689.729 322.912V315.689L692.728 310.952L692.019 306.69L695.569 300.06L694.857 297.099L696.751 294.495Z" },
                { id: "DF", messageX:"", messageY:"", d: "M552.854 240.38L550.131 239.198L548.474 241.329L543.623 238.131L542.794 234.224H539.598L539.007 231.263L536.168 229.486H526.82L524.451 234.224H522.321V237.54L519.719 239.552V242.514L510.252 243.341V246.182L506.82 249.38L505.518 246.776L503.152 247.13L502.558 249.38L501.14 248.788L499.128 249.38L498.653 250.683L495.933 248.67L490.489 248.434L489.187 251.986L484.927 253.762L487.887 255.418L492.264 254.235L496.878 253.762L501.14 254.827L502.204 252.223L503.27 252.104L504.69 254.117L505.281 259.089L503.27 262.168V265.484L505.399 269.391L504.215 271.995L505.399 276.969L507.529 279.337L509.068 284.192L515.457 286.796V289.639L521.258 291.061L523.506 288.691L526.344 289.285L530.249 293.192L532.854 291.416L535.338 295.914L541.966 298.994L545.871 299.112L548.946 303.492L559.125 303.967L564.214 305.625L568.534 302.783L569.597 297.927L572.378 296.151L572.536 291.258L574.902 289.915L576.638 288.178L574.665 287.075L573.956 282.416L572.142 281.152L571.827 278.312L574.508 274.956L573.562 271.641L568.473 271.404L567.525 269.628L553.326 269.864L554.39 261.813L552.736 259.919L552.615 257.67L553.799 255.775L553.208 253.405L554.272 250.919L552.142 248.552V246.776L553.917 246.421L554.272 241.92L552.854 240.38Z" },
                { id: "AC", messageX:"", messageY:"", d: "M484.927 253.762L461.496 244.169L439.13 231.383L408.718 224.869L394.517 217.962L395.386 220.765L392.348 221.711V223.921L394.556 226.291L396.234 227.237L395.05 228.719L397.003 231.086L397.652 234.578L400.848 238.546L403.332 239.552L405.346 242.514L405.286 245.057L401.854 248.907L408.894 249.085L413.511 250.031L415.522 254.117L415.168 256.485L427.179 256.366L435.994 249.203L437.355 249.734L437.118 252.893L435.658 254.196V269.864L437.158 269.273L438.933 271.01L441.656 270.813L445.521 268.879L448.203 269.746L455.185 269.352L459.602 270.022L460.826 272.114L466.033 269.943L468.833 265.366L472.974 266.075L474.394 264.299L478.417 261.104L481.968 260.274L487.887 255.418L484.927 253.762Z" },
                { id: "AM", messageX:"300", messageY:"313", d: "M597.349 220.844L596.834 217.765L593.68 214.527L592.969 211.371L596.283 208.844L620.956 153.113L623.795 151.337L624.407 149.639L622.514 148.93L619.714 151.694L616.558 152.364L614.94 151.534L614.901 148.93L610.602 145.298L607.091 145.772L600.227 141.352L600.581 138.469L599.36 136.654L596.598 138.866L593.877 136.417L593.68 134.247L589.815 131.089V128.406L587.761 126.669V119.327H573.087L568.119 129.591L569.697 132.116L566.856 133.064V134.562H563.778V132.51L559.204 129.273L554.629 131.327L553.051 134.247L552.497 138.984L554.944 142.616L553.366 144.114L551.236 141.194L548.553 141.667L546.738 137.247L540.822 133.222V131.327L543.82 131.958L545.635 128.721L541.612 120.434L541.769 117.433L540.27 114.432L542.006 110.17L539.598 103.796L536.995 101.547L538.534 99.8307L538.831 96.0997L535.99 94.9147L534.451 95.8029L532.854 93.4956L529.955 93.6139L526.699 94.56L524.511 96.16L521.73 95.6846L520.546 96.691L520.37 100.777L517.411 103.323L515.872 102.732L511.988 106.263L510.646 105.593L506.266 107.566L506.109 110.328L504.373 110.17L503.349 111.198L503.27 113.171L501.652 114.196L501.022 112.777L501.967 111.198L501.337 109.5L499.325 109.067L494.433 112.577L491.513 112.659L484.297 106.224L481.337 106.933L481.534 100.856L481.219 98.4881L479.641 98.0545L478.617 97.2637L478.735 93.8295L477.354 92.4104L475.815 93.6718L474.513 95.3692H472.698L470.292 97.9756L467.294 96.2388L466.427 97.6185L466.782 99.3159L451.911 99.7124L450.254 98.7246L445.561 99.8701L445.679 107.842L452.501 108.158L454.434 110.407L454.752 114.335L452.207 114.69L450.135 113.15L447.591 114.572L443.271 115.163L442.977 124.932L445.107 127.538L448.953 129.846L449.011 133.104L450.965 136.063L451.496 140.563L443.983 179.52L440.49 180.229L439.248 178.453L435.343 178.335L432.831 179.309L431.202 181.236L426.291 181.709L423.392 183.07L419.309 183.13L413.156 186.801L406.764 191.36L405.226 195.504V198.701L402.505 201.66L401.42 204.542L403.235 209.002L402.051 210.857L399.645 211.174L395.465 214.33L394.517 217.962L408.718 224.869L439.13 231.383L461.495 244.169L484.927 253.762L489.187 251.986L490.489 248.433L495.933 248.67L498.653 250.683L499.128 249.38L501.14 248.788L502.558 249.38L503.152 247.13L505.518 246.776L506.82 249.38L510.252 246.182V243.341L519.719 242.513V239.552L522.321 237.54V234.224H524.451L526.82 229.486H536.168L539.007 231.262L539.598 234.224H542.794L543.623 238.131L548.474 241.329L550.131 239.198L552.854 240.38L594.271 240.856V236.118L595.455 235.051L596.046 231.144L594.271 227.831L596.283 225.224V223.211L597.349 220.844Z" },
                { id: "RR", messageX:"", messageY:"", d: "M587.761 119.328L588 105.869L582.851 103.738L578.888 99.8308L576.876 96.9879L577.113 92.9021L573.739 87.7519V82.778L575.75 77.9827L575.85 74.5299L578.61 72.2018L579.006 68.6888L576.638 65.8853L577.743 64.0302L576.165 62.7688L571.63 62.0175L573.523 57.7949L573.444 54.676L571.036 52.3479L568.001 53.3357L564.45 52.8604L566.028 56.7282L561.136 59.8864L561.018 62.2934L556.956 62.0175L553.799 63.636L553.484 65.6093L550.249 65.7879L548.947 67.2093L547.292 66.676L545.693 68.0951L542.261 66.4395L539.716 68.6285L537.528 68.9833L536.523 72.7746L535.162 74.1357H534.096L533.445 72.123L531.612 70.1102L529.658 69.8134L528.238 70.8777L526.463 69.8134L521.494 70.3467L519.244 67.3856L513.742 67.4459L512.382 65.6093L511.198 65.3125L510.843 66.3212L515.103 71.7659L517.056 72.4175L519.186 75.0818L518.298 77.3914L518.831 81.1224L520.607 83.5479L521.612 85.8574L520.961 89.3496L524.806 90.9496L529.244 90.0615L529.955 93.614L532.854 93.4957L534.451 95.8029L535.99 94.9148L538.831 96.0998L538.534 99.8308L536.995 101.547L539.598 103.796L542.006 110.17L540.27 114.432L541.769 117.433L541.612 120.434L545.635 128.721L543.82 131.958L540.822 131.328V133.222L546.738 137.248L548.553 141.667L551.236 141.194L553.366 144.114L554.944 142.616L552.497 138.984L553.051 134.247L554.629 131.328L559.204 129.273L563.778 132.51V134.562H566.856V133.064L569.697 132.116L568.119 129.591L573.087 119.328H587.761Z" },
                { id: "AP", messageX:"", messageY:"", d: "M639.95 90.1195L641.844 98.7641L647.76 99.3554L650.953 103.501L656.872 104.329L658.766 106.342V110.013L662.789 113.565L662.316 117.472L665.155 124.341L668.469 126.827V129.906L670.835 130.497L669.889 134.168H672.019V136.893L676.16 138.787L680.065 138.312L681.604 136.417V133.222L685.391 128.485L686.575 124.932L690.48 121.853L693.912 121.261L697.105 117.827L697.935 114.453L701.958 113.092L704.56 109.067L705.154 105.278L703.97 99.2371L699.592 98.5276V95.5664L696.751 92.8441L693.794 94.0267L688.941 79.5827V70.2285L684.878 63.1235L682.591 63.7543L681.958 68.2551L680.223 69.1224L679.829 70.8592L677.935 72.2018L673.518 79.3856L670.48 86.1542L670.777 88.64L665.333 93.2592H661.192L659.653 91.1258L657.109 92.5473L654.979 91.3044H652.967L650.777 93.0806L646.576 93.2592L643.025 91.6012L642.02 89.8829L639.95 90.1195Z" },
                { id: "PA", messageX:"", messageY:"", d: "M700.419 254.59L702.667 247.13L706.217 241.447H709.177L713.436 234.815L714.975 227.355L711.307 224.988L711.188 222.62L713.909 219.777L713.673 215.634L715.802 213.266H719.591L721.721 208.056H724.442L727.401 197.992L724.56 195.031L721.603 195.859L719.353 194.082L723.851 191.478L731.543 183.782H734.502L741.364 174.901L742.075 170.166L746.571 164.955V159.508L749.649 156.429V153.588L752.251 150.982L753.554 144.707L753.317 138.787L742.312 133.34L731.543 130.734L729.413 132.51L723.258 129.433L724.324 127.182L722.903 125.405L718.171 126.117L710.361 121.973L707.874 117.709L701.958 118.539L703.142 115.342L701.958 113.092L697.935 114.453L697.105 117.827L693.912 121.262L690.48 121.853L686.575 124.932L685.391 128.485L681.604 133.222V136.417L680.065 138.312L676.16 138.787L672.019 136.893V134.168H669.889L670.835 130.497L668.469 129.906V126.827L665.155 124.341L662.316 117.473L662.789 113.565L658.766 110.013V106.342L656.872 104.329L650.953 103.502L647.76 99.3554L641.844 98.7641L639.95 90.1195L638.351 88.4036L634.21 88.8766L633.144 90.0615L628.47 90.1798L625.749 88.9949L623.795 92.2528L626.636 95.2117L626.103 97.7578L623.974 98.2308L619.418 96.5728L615.452 97.403L610.424 95.8633L607.467 96.6911L605.395 99.9491L602.732 99.1189L599.36 100.362L598.827 102.671L595.395 101.428L593.323 102.968L593.029 105.633L588 105.869L587.761 119.328V126.669L589.815 128.406V131.089L593.68 134.247L593.877 136.417L596.598 138.866L599.36 136.654L600.581 138.47L600.227 141.352L607.091 145.772L610.602 145.299L614.901 148.93L614.94 151.534L616.558 152.364L619.714 151.694L622.514 148.93L624.407 149.639L623.795 151.337L620.956 153.113L596.283 208.844L592.969 211.372L593.68 214.528L596.834 217.765L597.349 220.844L599.833 222.502L601.49 228.185L603.856 232.093V235.29L605.04 240.025H607.288V241.802H609.654L612.02 243.933V246.182H614.862L616.282 248.434L700.419 254.59Z" },
                { id: "TO", messageX:"", messageY:"", d: "M723.851 191.478L727.047 193.609L729.058 192.545H731.188L731.897 194.676L735.566 196.095V199.766L736.986 201.66L737.577 207.107L735.447 216.461L732.845 218.477L733.436 220.253H735.566L737.104 221.79L736.277 223.685L742.312 230.79L744.796 228.422H747.874L749.412 230.198L748.819 233.869L744.796 234.697L743.375 240.737L741.482 243.696L745.032 245.827L745.505 249.025H747.28L748.346 250.683L746.689 252.814L749.412 254.59L750.003 259.089H756.392L758.997 260.983L753.081 265.484L749.294 272.234L747.044 273.535L748.583 276.851L751.542 277.799L750.121 286.796L752.251 289.521L751.542 296.626H745.387L737.577 300.415L734.502 297.572L733.318 298.521L734.502 302.073L733.318 303.849L730.952 300.652L729.058 300.297L727.165 301.598L726.335 298.284L722.194 301.243V297.217L718.053 293.783L716.632 296.151L713.791 294.02L711.307 297.217V300.888L704.324 296.269L699.946 294.85L702.194 289.521H698.408L696.751 294.495L694.385 291.237L695.569 287.685L695.094 278.745L693.437 277.087L693.733 273.595L695.094 272.234L695.687 265.129L700.419 254.59L702.667 247.13L706.217 241.447H709.177L713.436 234.815L714.975 227.355L711.307 224.988L711.188 222.62L713.909 219.777L713.673 215.634L715.802 213.266H719.591L721.721 208.056H724.442L727.401 197.992L724.56 195.031L721.603 195.859L719.353 194.082L723.851 191.478Z" },
                { id: "MA", messageX:"900", messageY:"313", d: "M756.393 259.088L758.168 248.846L754.974 241.565L758.168 238.013L761.363 225.048L773.257 222.56L777.34 218.298L779.291 213.502L784.971 212.081L788.167 214.745L794.913 212.969L796.331 206.219L792.781 203.557L792.605 197.871L797.043 193.788V188.104L794.735 185.973L796.155 182.421L794.735 178.513L798.463 174.604V172.118L800.593 168.744L805.386 169.632L812.129 161.758L809.527 159.272L804.556 158.205L801.481 159.272L789.527 153.707L787.752 154.534L785.386 152.522L781.599 157.259L780.533 155.244L777.103 156.429L775.09 155.007L775.801 150.272L771.303 142.458L768.582 140.563L763.73 145.298L762.311 140.682L758.643 141.391L753.317 138.787L753.554 144.707L752.251 150.982L749.649 153.588V156.429L746.571 159.508V164.955L742.075 170.166L741.364 174.901L734.502 183.782H731.543L723.851 191.478L727.047 193.609L729.058 192.545H731.188L731.897 194.676L735.566 196.095V199.766L736.986 201.66L737.577 207.107L735.447 216.461L732.845 218.476L733.436 220.253H735.566L737.104 221.79L736.277 223.684L742.312 230.789L744.796 228.422H747.874L749.412 230.198L748.819 233.869L744.796 234.697L743.375 240.737L741.482 243.696L745.032 245.827L745.505 249.025H747.28L748.346 250.683L746.689 252.814L749.412 254.59L750.003 259.088H756.393Z" },
                { id: "PI", messageX:"", messageY:"", d: "M758.997 260.983L759.649 259.089L761.63 259.355L762.666 261.901L762.251 264.802L764.765 267.733L769.025 269.213L773.078 265.247L776.095 264.151L779.291 265.542L785.208 257.609V254.293L783.078 251.156L788.049 246.715L790.239 249.025L793.907 248.491L796.688 251.392L800.296 250.21L803.216 247.664L809.212 246.715L810.947 242.947L813.708 242.393L816.864 239L820.729 235.448L825.225 231.817L826.094 227.316L823.886 226.37L824.359 224.396L823.728 222.66L826.488 221.553L827.83 213.66L823.571 211.529L821.517 203.636L821.184 192.603L817.161 188.341L819.054 177.98L814.813 167.796L815.443 162.231L812.129 161.758L805.386 169.632L800.593 168.744L798.463 172.118V174.604L794.735 178.514L796.155 182.421L794.735 185.973L797.043 188.104V193.788L792.605 197.871L792.781 203.557L796.331 206.219L794.913 212.969L788.167 214.745L784.971 212.081L779.291 213.502L777.34 218.298L773.257 222.56L761.363 225.048L758.168 238.013L754.974 241.565L758.168 248.846L756.393 259.089L758.997 260.983Z" },
                { id: "CE", messageX:"900", messageY:"313", d: "M826.488 221.554L830.768 222.738L836.094 220.074L841.952 222.738V225.936L844.791 228.243L850.117 225.048L852.247 220.074L849.229 215.485L852.247 208.707L851.181 206.219L854.022 203.2H856.863L859.88 196.807L862.897 188.635L868.696 188.162L867.866 185.322L863.016 184.255L861.713 181.769L858.993 180.939L853.194 172.652L848.696 171.585L841.714 165.547L834.022 160.93L828.224 159.745L822.071 161.285L815.443 162.231L814.813 167.796L819.054 177.98L817.16 188.341L821.184 192.603L821.517 203.636L823.57 211.529L827.83 213.66L826.488 221.554Z" },
                { id: "RN", messageX:"", messageY:"", d: "M891.652 209.771H884.197L880.825 206.397L877.808 207.819L879.229 212.79L877.453 216.343H875.145V212.79L871.595 212.436L868.696 214.39L865.206 212.259L866.448 208.174L870.174 204.621L868.696 203.2L862.543 205.864L861.655 208.707L857.75 210.483L852.247 208.707L851.181 206.219L854.022 203.2H856.863L859.88 196.807L862.898 188.635L868.696 188.162L870.707 189.465L873.667 188.756L875.56 190.411L882.304 191.478L885.145 190.057L891.061 191.478L890.943 198.938L891.652 209.771Z" },
                { id: "PB", messageX:"900", messageY:"313", d: "M890.234 225.224L885.972 228.243L881.358 226.291L876.92 228.243V232.151L871.416 234.284L869.465 232.508L869.998 230.374L867.157 229.31L871.416 221.317L868.696 220.074L863.074 225.048L857.75 228.243L854.555 226.112L851.181 227.179L850.117 225.048L852.247 220.074L849.229 215.485L852.247 208.707L857.75 210.483L861.655 208.707L862.543 205.864L868.696 203.2L870.174 204.621L866.448 208.174L865.206 212.26L868.696 214.391L871.595 212.436L875.145 212.791V216.343H877.453L879.229 212.791L877.808 207.819L880.825 206.398L884.197 209.772H891.652L890.234 225.224Z" },
                { id: "PE", messageX:"", messageY:"", d: "M890.943 240.38L883.252 242.393L881.949 245.472L877.096 247.84L872.01 248.315L866.211 243.223H862.897V240.855L860.65 241.447L859.938 244.881L855.679 247.603L854.613 243.814L843.371 239.67V237.421L841.241 236.709L836.627 238.249L833.904 241.092V243.696L829.644 244.368L828.815 248.079L825.267 249.734H822.78L824.201 245.472L821.598 241.565L816.864 239L820.729 235.448L825.225 231.817L826.094 227.316L823.886 226.37L824.358 224.396L823.728 222.659L826.488 221.553L830.768 222.738L836.094 220.074L841.952 222.738V225.936L844.791 228.243L850.117 225.048L851.18 227.179L854.555 226.112L857.75 228.243L863.074 225.048L868.696 220.074L871.416 221.317L867.157 229.31L869.998 230.374L869.465 232.508L871.416 234.284L876.92 232.15V228.243L881.358 226.291L885.972 228.243L890.234 225.224L890.943 240.38Z" },
                { id: "AL", messageX:"900", messageY:"313", d: "M890.943 240.38L883.252 242.393L881.949 245.472L877.097 247.84L872.01 248.315L866.212 243.223H862.898V240.855L860.65 241.447L859.938 244.881L855.679 247.603L858.696 250.919L864.318 253.644H867.512L872.601 256.011L873.192 259.089L877.097 260.037L879.898 263.313L881.083 260.155L884.315 258.103L888.181 252.262L890.943 240.38Z" },
                { id: "SE", messageX:"900", messageY:"313", d: "M858.15 249.635L857.144 252.478L858.15 255.319H860.931L862.115 259.82L859.628 260.529L860.694 264.436L858.801 265.385L857.144 263.963L854.541 264.318L853.712 266.922L858.15 271.305V274.382L862.115 276.276L866.098 275.685L869.174 271.423L870.909 267.555L875.723 263.291L879.352 262.029L876.55 258.753L872.645 257.805L872.054 254.727L866.965 252.36H863.772L858.15 249.635Z" },
                { id: "BA", messageX:"900", messageY:"313", d: "M758.997 260.983L753.081 265.484L749.294 272.234L747.044 273.535L748.583 276.851L751.542 277.799L750.121 286.796L752.251 289.521L751.542 296.626V301.598L752.724 304.44L751.66 311.309L756.393 314.861L755.014 321.727L755.486 323.858L753.041 325.911L754.46 326.938L758.564 325.28L765.111 320.069L767.319 319.991L771.817 315.807L778.207 313.261L783.65 314.701L782.466 318.966L787.595 321.097L791.066 318.966H794.065L803.138 325.438L804.873 324.334L806.767 326.071L810.236 324.964L816.076 330.175L815.68 333.57L818.284 333.806L820.572 332.385L828.382 334.358L834.537 337.674L834.14 340.911L829.723 344.621L829.014 346.831L830.433 347.935L829.487 349.041H826.173L825.621 355.513L830.829 361.039L829.496 363.024L836.803 367.671L840.057 362.52L842.365 361.927L844.258 359.262L842.958 357.962L843.134 352.869L844.437 349.85L843.964 348.014L845.088 341.679L848.105 336.471L848.045 334.219L846.448 331.793L846.527 328.438L844.949 320.702L844.87 318.175L846.764 314.386L847.158 309.097L845.818 307.993L845.66 306.729L847.394 305.544L847.633 302.94L846.212 301.125L846.448 299.467L853.628 296.311L858.835 291.494L862.543 286.205L866.645 276.969L862.661 277.56L858.696 275.666V272.589L854.258 268.206L855.088 265.602L857.69 265.247L859.347 266.669L861.241 265.72L860.175 261.813L862.661 261.104L861.477 256.603H858.696L857.69 253.762L858.696 250.919L855.679 247.603L854.613 243.814L843.371 239.671V237.421L841.241 236.709L836.627 238.249L833.904 241.092V243.696L829.645 244.369L828.815 248.079L825.267 249.734H822.78L824.201 245.472L821.598 241.565L816.864 239L813.708 242.393L810.947 242.947L809.212 246.715L803.216 247.664L800.296 250.21L796.688 251.392L793.907 248.491L790.239 249.025L788.049 246.715L783.078 251.156L785.208 254.293V257.609L779.291 265.542L776.095 264.151L773.078 265.247L769.025 269.213L764.765 267.733L762.251 264.802L762.599 261.737L761.63 259.355L759.648 259.089L758.997 260.983Z" },
            ],
            content: []
        }
    }
    style() {
        return `
            <style>
                .thp-brazil-map > div {
                }
                #AM, #MA, #CE, #PB, #AL, #SE, #BA, #RJ, #MG, #ES, #SP {
                    fill: #80B356;
                    stroke: #2F431E;
                    transition: all 0.3s ease; 
                    
                }
                #AM:hover, #MA:hover, #CE:hover,
                #PB:hover, #AL:hover, #SE:hover, #BA:hover,
                #SP:hover, #RJ:hover, #MG:hover, #ES:hover {
                    fill: #EC8A41;
                }
                svg path{
                    pointer-events:all;
                    stroke: #80B357;
                    stroke-width: 3; 
                    stroke-linecap: round;
                    stroke-linejoin: round; 
                }
                .white-line{
                    stroke: white;
                    stroke-width: 1.5;
                    stroke-dasharray: var(--tamanhoTotalDoPath);
                    stroke-dashoffset: 0;
                    animation: desenha 1s alternate;
                }
                .hide {
                    display: none;
                }
               
                @keyframes desenha {
                    /* inicio: ponto inicial */
                    from {
                        stroke-dashoffset: var(--tamanhoTotalDoPath);
                    }
                    /* fim: Altera o inicio para 0  */
                    to {
                        stroke-dashoffset: 0;
                    }
                }
                @media (max-width: 640px) {
                    .thp-brazil-map {
                        width:100%;
                    }
                }
            </style>
        `
    }
    createStates() {
        return this.data().states.reduce((acc, current) => acc + `<path id='${current.id}' class='thp-brazil-state' d='${current.d}' />`, '');
    }
    render() {
        this.shadow.innerHTML = `
            ${this.style()}
            <svg class="thp-brazil-map" width="1284" height="626" viewBox="0 0 1284 626" fill="none">              
                ${this.createStates()} 
                <path class="white-line hide" fill="none"/>
                <circle class="circle hide" r="3" fill="white" />
                <foreignObject class='message-box-container' x="" y="" width="360" height="80">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                        <message-box-component></message-box-component>
                    </div>
                </foreignObject>
            </svg>
        `;
    }
}
customElements.define("brazil-map-component", BrazilMapComponent);

class MessageBoxComponent extends HTMLElement {
    constructor() {
        super();
        this.shadow = this.attachShadow({ mode: "open" })
    }
    connectedCallback() {
        this.render();
    }
    data() {
        return {
            messages: {
                ptBr: [
                    { id: "AL", name: 'ALAGOAS', beneficiaries: "100", tagStudents: "", projects: "Cultura em Foco (2015)" },
                    { id: "AM", name: 'AMAZONAS', beneficiaries: "1500", tagStudents: "", projects: "Hb" },
                    { id: "BA", name: 'BAHIA', beneficiaries: "30", tagStudents: "", projects: "Ed Mundo" },
                    { id: "CE", name: 'CEARÁ', beneficiaries: "80", tagStudents: "1078", projects: "Ed Mundo, Synapse, TAG" },
                    { id: "ES", name: 'ESPÍRITO SANTO', beneficiaries: "", tagStudents: "7879", projects: "TAG" },
                    { id: "MA", name: 'MARANHÃO', beneficiaries: "320", tagStudents: "13417", projects: "Synapse, TAG" },
                    { id: "MG", name: 'MINAS GERAIS', beneficiaries: "180", tagStudents: "1202", projects: "Synapse, TAG" },
                    { id: "PB", name: 'PARAÍBA', beneficiaries: "", tagStudents: "1617", projects: "TAG" },
                    { id: "RJ", name: 'RIO DE JANEIRO', beneficiaries: "", tagStudents: "25621", projects: "TAG" },
                    { id: "SE", name: 'SERGIPE', beneficiaries: "7458", tagStudents: "22704", projects: " Synapse, TAG, Cultura em Foco (2015), Hb" },
                    { id: "SP", name: 'SÃO PAULO', beneficiaries: "", tagStudents: "1997", projects: "TAG" },
                ]
            }
        }
    }
    style() {
        return `
        <style>
            .thp-message-box{
                color: white;
                width: fit-content;
                padding-top: 10px;
            }
            .thp-message-box span {
                font-size: 12px;
            }
            .hide {
                visibility: hidden;
            }
        </style>
        `
    }
    createMessage(id) {
        let element = this.data().messages.ptBr.find((item) => item.id == id)
        const messageBox = this.shadow.querySelector(".thp-message-box")
        if (element != undefined) {
            let message = `<span>${element.name}</span><br/>`
            if (element.beneficiaries != "") {
                message += `${element.beneficiaries} benefeciados </br>`
            }
            if (element.tagStudents != "") {
                message += `${element.tagStudents} alunos cadastrados no TAG <br>`
            }
            message += `Projeto(s) - ${element.projects}`
            messageBox.innerHTML = message
        }
    }
    clearMessage() {
        const messageBox = this.shadow.querySelector(".thp-message-box")
        messageBox.innerHTML = ''
        messageBox.classList.add('hide')
    }
    showMessage() {
        const messageBox = this.shadow.querySelector(".thp-message-box")
        messageBox.classList.remove('hide')
    }
    position() {
        const messageBox = this.shadowRoot.querySelector('.thp-message-box')

        const coordinatesBMessage = {
            x: messageBox.offsetLeft,
            y: messageBox.offsetTop,
            offsetHeight: messageBox.offsetHeight,
            offsetWidth: messageBox.offsetWidth
        }
        return coordinatesBMessage;
    }
    render() {
        this.shadow.innerHTML = `
            ${this.style()}
            <div class='thp-message-box hide'>
            </div>
        `;
    }
}
customElements.define("message-box-component", MessageBoxComponent);
class MapContainerComponent extends HTMLElement {
    constructor() {
        super();
        this.shadow = this.attachShadow({ mode: "open" })
    }
    connectedCallback() {
        this.render();
    }
    style() {
        return `
            <style>
                .thp-brasilmap-container{
                    overflow: hidden;
                    width:100vw;
                    height:100vh;
                    background-color:#2F431E;
                    display:flex;
                    align-items: center;
                    justify-content:center;
                    position:relative;
                }
                
            </style>
        `
    }
    render() {
        this.shadow.innerHTML = `
            ${this.style()}
            <div class="thp-brasilmap-container">
                    <brazil-map-component></brazil-map-component>
                    
                
            </div>
        `
    }
}
customElements.define("map-container-component", MapContainerComponent);